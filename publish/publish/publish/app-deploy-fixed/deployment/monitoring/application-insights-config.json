{
  "applicationInsights": {
    "instrumentationKey": "#{APPINSIGHTS_INSTRUMENTATIONKEY}#",
    "connectionString": "#{APPLICATIONINSIGHTS_CONNECTION_STRING}#",
    "enableAdaptiveSampling": true,
    "samplingSettings": {
      "isEnabled": true,
      "maxTelemetryItemsPerSecond": 20,
      "excludedTypes": "Dependency;Exception"
    },
    "enableQuickPulseMetricStream": true,
    "enableDependencyTracking": true,
    "enablePerformanceCountersCollection": true,
    "enableEventCounterCollection": true
  },
  "telemetry": {
    "customMetrics": [
      {
        "name": "maritime.vessel.position.updates",
        "description": "Number of vessel position updates processed per minute",
        "unit": "Count",
        "aggregation": "Sum"
      },
      {
        "name": "maritime.fuel.consumption.rate",
        "description": "Real-time fuel consumption rate across fleet",
        "unit": "Liters/Hour",
        "aggregation": "Average"
      },
      {
        "name": "maritime.co2.emissions.rate",
        "description": "CO2 emissions rate per vessel",
        "unit": "kg/Hour",
        "aggregation": "Average"
      },
      {
        "name": "maritime.battery.efficiency",
        "description": "Battery efficiency percentage across hybrid fleet",
        "unit": "Percent",
        "aggregation": "Average"
      },
      {
        "name": "maritime.passenger.notifications.sent",
        "description": "Passenger notifications sent per hour",
        "unit": "Count",
        "aggregation": "Sum"
      },
      {
        "name": "maritime.northern.lights.alerts",
        "description": "Northern Lights alerts generated",
        "unit": "Count",
        "aggregation": "Sum"
      },
      {
        "name": "maritime.route.optimizations.applied",
        "description": "Route optimizations successfully applied",
        "unit": "Count",
        "aggregation": "Sum"
      },
      {
        "name": "maritime.safety.incidents.reported",
        "description": "Safety incidents reported per day",
        "unit": "Count",
        "aggregation": "Sum"
      }
    ],
    "customEvents": [
      {
        "name": "VesselDeparture",
        "properties": {
          "vesselName": "string",
          "departurePort": "string",
          "arrivalPort": "string",
          "passengerCount": "number",
          "scheduledDepartureTime": "datetime"
        }
      },
      {
        "name": "EmergencyAlert",
        "properties": {
          "vesselName": "string",
          "alertType": "string",
          "severity": "string",
          "location": "string",
          "responseTime": "number"
        }
      },
      {
        "name": "NorthernLightsViewing",
        "properties": {
          "vesselName": "string",
          "auroraIntensity": "string",
          "viewingProbability": "number",
          "passengerCount": "number",
          "weatherConditions": "string"
        }
      },
      {
        "name": "EnvironmentalThresholdExceeded", 
        "properties": {
          "vesselName": "string",
          "emissionType": "string",
          "currentValue": "number",
          "thresholdValue": "number",
          "location": "string"
        }
      },
      {
        "name": "RouteOptimizationApplied",
        "properties": {
          "vesselName": "string",
          "fuelSavings": "number",
          "timeSavings": "number",
          "co2Reduction": "number",
          "optimizationFactors": "string"
        }
      }
    ]
  },
  "alertRules": [
    {
      "name": "High Error Rate Alert",
      "description": "Alert when error rate exceeds 5% over 5 minutes",
      "query": "requests | where timestamp > ago(5m) | summarize errorRate = 100.0 * countif(success == false) / count() | where errorRate > 5",
      "frequency": "PT5M",
      "timeWindow": "PT5M",
      "severity": "2",
      "actionGroups": ["maritime-operations-team"],
      "enabled": true
    },
    {
      "name": "Vessel Position Update Failure",
      "description": "Alert when vessel position updates stop for more than 10 minutes",
      "query": "customMetrics | where name == 'maritime.vessel.position.updates' | where timestamp > ago(10m) | summarize sum(value) | where sum_value == 0",
      "frequency": "PT10M", 
      "timeWindow": "PT10M",
      "severity": "1",
      "actionGroups": ["maritime-operations-team", "maritime-technical-team"],
      "enabled": true
    },
    {
      "name": "CO2 Emissions Threshold Exceeded",
      "description": "Alert when any vessel exceeds CO2 emission thresholds",
      "query": "customEvents | where name == 'EnvironmentalThresholdExceeded' | where customDimensions.emissionType == 'CO2' | where timestamp > ago(15m)",
      "frequency": "PT5M",
      "timeWindow": "PT15M", 
      "severity": "2",
      "actionGroups": ["maritime-environmental-team", "maritime-operations-team"],
      "enabled": true
    },
    {
      "name": "Emergency Alert Response Time",
      "description": "Alert when emergency response time exceeds 5 minutes",
      "query": "customEvents | where name == 'EmergencyAlert' | where customDimensions.responseTime > 300 | where timestamp > ago(1h)",
      "frequency": "PT5M",
      "timeWindow": "PT1H",
      "severity": "0",
      "actionGroups": ["maritime-emergency-team", "maritime-management"],
      "enabled": true
    },
    {
      "name": "High Northern Lights Viewing Opportunity",
      "description": "Notification when excellent Northern Lights viewing conditions are detected",
      "query": "customEvents | where name == 'NorthernLightsViewing' | where customDimensions.viewingProbability > 85 | where timestamp > ago(3h)",
      "frequency": "PT1H",
      "timeWindow": "PT3H",
      "severity": "4",
      "actionGroups": ["maritime-passenger-services"],
      "enabled": true
    }
  ],
  "dashboards": [
    {
      "name": "Maritime Operations Dashboard",
      "description": "Real-time monitoring of MaritimeIQ Platform operations",
      "tiles": [
        {
          "name": "Request Volume",
          "type": "chart",
          "query": "requests | where timestamp > ago(1h) | summarize count() by bin(timestamp, 5m)",
          "position": { "x": 0, "y": 0, "width": 6, "height": 4 }
        },
        {
          "name": "Error Rate",
          "type": "chart", 
          "query": "requests | where timestamp > ago(1h) | summarize errorRate = 100.0 * countif(success == false) / count() by bin(timestamp, 5m)",
          "position": { "x": 6, "y": 0, "width": 6, "height": 4 }
        },
        {
          "name": "Vessel Position Updates",
          "type": "chart",
          "query": "customMetrics | where name == 'maritime.vessel.position.updates' | where timestamp > ago(1h) | summarize sum(value) by bin(timestamp, 5m)",
          "position": { "x": 0, "y": 4, "width": 6, "height": 4 }
        },
        {
          "name": "Fleet Fuel Consumption",
          "type": "chart",
          "query": "customMetrics | where name == 'maritime.fuel.consumption.rate' | where timestamp > ago(1h) | summarize avg(value) by bin(timestamp, 5m)",
          "position": { "x": 6, "y": 4, "width": 6, "height": 4 }
        },
        {
          "name": "CO2 Emissions Trend",
          "type": "chart", 
          "query": "customMetrics | where name == 'maritime.co2.emissions.rate' | where timestamp > ago(1h) | summarize avg(value) by bin(timestamp, 5m)",
          "position": { "x": 0, "y": 8, "width": 6, "height": 4 }
        },
        {
          "name": "Battery Efficiency",
          "type": "chart",
          "query": "customMetrics | where name == 'maritime.battery.efficiency' | where timestamp > ago(1h) | summarize avg(value) by bin(timestamp, 5m)",
          "position": { "x": 6, "y": 8, "width": 6, "height": 4 }
        }
      ]
    }
  ],
  "workbooks": [
    {
      "name": "Maritime Fleet Performance Analysis",
      "description": "Comprehensive analysis of fleet performance, environmental compliance, and passenger experience",
      "sections": [
        {
          "name": "Fleet Overview",
          "visualizations": [
            {
              "type": "kql",
              "title": "Active Vessels by Performance",
              "query": "customMetrics | where name in ('maritime.fuel.consumption.rate', 'maritime.co2.emissions.rate', 'maritime.battery.efficiency') | where timestamp > ago(1d) | summarize avg(value) by name, tostring(customDimensions.vesselName) | render columnchart"
            }
          ]
        },
        {
          "name": "Environmental Compliance",
          "visualizations": [
            {
              "type": "kql", 
              "title": "Emission Threshold Violations",
              "query": "customEvents | where name == 'EnvironmentalThresholdExceeded' | where timestamp > ago(7d) | summarize count() by tostring(customDimensions.emissionType), tostring(customDimensions.vesselName) | render barchart"
            }
          ]
        },
        {
          "name": "Passenger Experience",
          "visualizations": [
            {
              "type": "kql",
              "title": "Northern Lights Viewing Opportunities",
              "query": "customEvents | where name == 'NorthernLightsViewing' | where timestamp > ago(30d) | summarize opportunities = count(), avgProbability = avg(todouble(customDimensions.viewingProbability)) by tostring(customDimensions.vesselName) | render table"
            }
          ]
        }
      ]
    }
  ],
  "actionGroups": [
    {
      "name": "maritime-operations-team",
      "displayName": "Maritime Operations Team",
      "receivers": [
        {
          "type": "email",
          "emailAddress": "operations@maritimeiq.com"
        },
        {
          "type": "sms",
          "phoneNumber": "+4799999999"
        }
      ]
    },
    {
      "name": "maritime-technical-team", 
      "displayName": "Maritime Technical Team",
      "receivers": [
        {
          "type": "email",
          "emailAddress": "technical@maritimeiq.com"
        }
      ]
    },
    {
      "name": "maritime-environmental-team",
      "displayName": "Maritime Environmental Team", 
      "receivers": [
        {
          "type": "email",
          "emailAddress": "environmental@maritimeiq.com"
        }
      ]
    },
    {
      "name": "maritime-emergency-team",
      "displayName": "Maritime Emergency Response Team",
      "receivers": [
        {
          "type": "email",
          "emailAddress": "emergency@maritimeiq.com"
        },
        {
          "type": "sms", 
          "phoneNumber": "+4788888888"
        },
        {
          "type": "webhook",
          "serviceUri": "https://maritimeiq-emergency-response.azurewebsites.net/webhook"
        }
      ]
    },
    {
      "name": "maritime-passenger-services",
      "displayName": "Maritime Passenger Services",
      "receivers": [
        {
          "type": "email",
          "emailAddress": "passenger-services@maritimeiq.com"
        }
      ]
    },
    {
      "name": "maritime-management",
      "displayName": "Maritime Management Team",
      "receivers": [
        {
          "type": "email",
          "emailAddress": "management@maritimeiq.com"
        }
      ]
    }
  ]
}